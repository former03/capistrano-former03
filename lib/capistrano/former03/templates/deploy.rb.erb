# ensure this version of capistrano is used
lock '<%= Capistrano::VERSION %>'

set :application, '<MY_APP_NAME>'

# Link files into deploy destination
# set :linked_files, ['wwwroot/config.inc.php']

# Link directories into deploy destination
# set :linked_dirs, ['wwwroot/typo3temp']

# Default value for keep_releases is 5
# set :keep_releases, 5

# Ensure rights for all files/dirs
# set :ensure_file_mode, '644'
# set :ensure_dir_mode, '755'

# Special rights for single files
#set :ensure_path_mode, {
#  'wwwroot/secret.conf'         => '400',
#  'wwwroot/public_writable_dir' => '777',
#}

# Set mysql connnections settings
#set :mysql_connections, {
#    :production => {
#        :host     => 'host1',
#        :port     => 3306,
#        :database => 'dbname',
#        :username => 'user1',
#        :password => 'password',
#    },
#    :staging => {
#        :host     => 'host1',
#        :port     => 3306,
#        :database => 'dbname',
#        :username => 'user1',
#        :password => 'password',
#    },
#}

# Create files from database settings
#set :mysql_templates, [
#    {
#        :destination => 'wwwroot/wp-database.php',
#        :template    => 'config/wp-database.php.erb',
#    }
#]
# Enable mysql templates
#before 'former03:local:fix_rights', 'former03:mysql:templates'

# Create mysqldump before deploy
#before 'former03:remote:release', 'former03:mysql:backup'

## Sync database from production
## * works in non production stages only
## * performs mysqldump backup
#before 'former03:remote:release', 'former03:mysql:sync'

# Execute custom task after local stage (example default task)
=begin
namespace :custom do
  desc 'Run rakefile'
  task :rakefile do
    run_locally do
      within fetch(:local_stage_path) do
        execute 'bundle exec rake'
      end
    end
  end
end
after 'former03:local:stage', 'custom:rakefile'
=end
